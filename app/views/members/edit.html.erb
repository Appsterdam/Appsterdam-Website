<h1><%= @title = "Update your membership listing" %></h1>

<%= form_for @authenticated do |f| %>
  <fieldset>
    <legend>Profile</legend>
    <dl>
    <dt>Image:<dt>
    <dd><%= image_tag @authenticated.picture %></dd>
    <dt>Twitter username:</dt>
    <dd><%=h @authenticated.username %></dd>
    <!-- NOTE: We should use the Twitter ID internally because the username can be changed. -->
    <dt>Name:</dt>
    <dd><%=h @authenticated.name %></dd>
    <dt>Location:</dt>
    <dd><%=h @authenticated.location %></dd>
    <dt>Web:</dt>
    <dd><%= link_to @authenticated.website, @authenticated.website %></dd>
    <dt>Description:</dt>
    <dd><%=h @authenticated.bio %></dd>
    </dl>
    <p>Want to make changes? Update your profile information on Twitter, then return to this page.</p>
  </fieldset>

  <fieldset>
    <legend>Listing</legend>

    <div>
      What are you?
      <% Member::ENTITIES.each do |value, label| %>
        <% id = "member_entity_#{value}" %>
        <label for="<%= id %>"><%= f.radio_button :entity, value, :id => id %> <%= label %></label>
      <% end %>
    </div>
    <div class="when_entity_is company">
      <label for="member_job_offers_url">Is your company currently hiring? Please enter the webpage with your job offer(s) below:</label>
      <%= f.text_field :job_offers_url %>
    </div>
    <div class="when_entity_is student individual">
      Are you currently available for hire?
      <label for="member_available_for_hire"><%= f.check_box :available_for_hire %> Yes, Iâ€™m available for hire</label>
    </div>

    <div>
      Where do you work?
      <% Member::WORK_LOCATIONS.each do |value, label| %>
        <% id = "member_work_location_#{value}" %>
        <label for="<%= id %>"><%= f.radio_button :work_location, value, :id => id %> <%= label %></label>
      <% end %>
    </div>

    <div>
      <span class="when_entity_is company">
        What kind of work does your company do?
      </span>
      <span class="when_entity_is student">
        What kind of subjects do you study?
      </span>
      <span class="when_entity_is individual default">
        What kind of work do you do?
      </span>
      <span class="when_entity_is group">
        What subjects is your group concerned with?
      </span>
      <% Member::WORK_TYPES.each do |value, label| %>
        <% id = "member_work_types_#{value}" %>
        <label for="<%= id %>"><%= f.check_box :work_types, { :multiple => true, :id => id }, value, '' %> <%= label %></label>
      <% end %>
    </div>

    <div>
      For which platforms?
      <% Member::PLATFORMS.each do |value, label| %>
        <% id = "member_work_types_#{value}" %>
        <label for="<%= id %>"><%= f.check_box :platforms, { :multiple => true, :id => id }, value, '' %> <%= label %></label>
      <% end %>
    </div>
  </fieldset>

  <%= f.submit "Update membership listing" %>
  <%= link_to "Cancel and go back", members_path %>
<% end %>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js" type="text/javascript"></script>
<script>
(function(){
  $(".when_entity_is:not(.default)").hide();
  function update(field) {
    $(".when_entity_is:not(." + field.value + ")").hide();
    $(".when_entity_is." + field.value).show();
  }
  $('input[name="member[entity]"]').click(function() {
    update(this);
  })
  $('input[name="member[entity]"][checked]').each(function() {
    update(this);
  });
})();
</script>
